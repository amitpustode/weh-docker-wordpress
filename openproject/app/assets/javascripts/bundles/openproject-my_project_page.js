!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="/assets/bundles/",__webpack_require__(__webpack_require__.s=1136)}({1136:function(module,exports,__webpack_require__){var requireComponent=__webpack_require__(266);requireComponent.keys().forEach(requireComponent)},266:function(module,exports,__webpack_require__){function webpackContext(req){return __webpack_require__(webpackContextResolve(req))}function webpackContextResolve(req){var id=map[req];if(!(id+1))throw new Error("Cannot find module '"+req+"'.");return id}var map={"./projects-overview/overview-block.directive.ts":492,"./projects-overview/overview-page-layout.directive.ts":493,"./projects-overview/overview-textile-block.directive.ts":494};webpackContext.keys=function(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=266},492:function(module,exports,__webpack_require__){"use strict";function overviewBlock(){return{restrict:"EA",scope:{},transclude:!0,compile:function(){return function(scope,element,attrs,ctrl,transclude){scope.$ctrl.layoutCtrl=ctrl,transclude(scope,function(clone){element.append(clone)})}},require:"?^overviewPageLayout",controller:OverviewBlockController,bindToController:!0,controllerAs:"$ctrl"}}Object.defineProperty(exports,"__esModule",{value:!0});var OverviewBlockController=function(){function OverviewBlockController($element){this.$element=$element}return OverviewBlockController.$inject=["$element"],Object.defineProperty(OverviewBlockController.prototype,"editing",{get:function(){return!!this.layoutCtrl},enumerable:!0,configurable:!0}),OverviewBlockController.prototype.remove=function(){this.$element.remove()},OverviewBlockController}();exports.OverviewBlockController=OverviewBlockController,angular.module("openproject").directive("overviewBlock",overviewBlock)},493:function(module,exports,__webpack_require__){"use strict";function overviewPageLayout(){return{restrict:"E",scope:{},transclude:!0,compile:function(){return function(scope,element,attrs,ctrls,transclude){transclude(scope,function(clone){element.append(clone),scope.$ctrl.initialize()})}},bindToController:!0,controller:ProjectsOverviewController,controllerAs:"$ctrl"}}Object.defineProperty(exports,"__esModule",{value:!0});var ProjectsOverviewController=function(){function ProjectsOverviewController($element,$scope,$http,$compile,wpNotificationsService){this.$element=$element,this.$scope=$scope,this.$http=$http,this.$compile=$compile,this.wpNotificationsService=wpNotificationsService}return ProjectsOverviewController.$inject=["$element","$scope","$http","$compile","wpNotificationsService"],ProjectsOverviewController.prototype.initialize=function(){this.updateAvailableBlocks()},Object.defineProperty(ProjectsOverviewController.prototype,"addForm",{get:function(){return this.$element.find("#add-block-form")},enumerable:!0,configurable:!0}),Object.defineProperty(ProjectsOverviewController.prototype,"saveForm",{get:function(){return this.$element.find("#save-block-form")},enumerable:!0,configurable:!0}),Object.defineProperty(ProjectsOverviewController.prototype,"hiddenContainer",{get:function(){return this.$element.find("#list-hidden")},enumerable:!0,configurable:!0}),ProjectsOverviewController.prototype.activeBlockNames=function(container){var _this=this;return container||(container=this.$element),container.find(".widget-box").map(function(i,el){return _this.blockNameFromId(el.id)}).toArray()},ProjectsOverviewController.prototype.noteRemovedBlock=function(blockName){angular.element("<input>").attr({type:"hidden",name:"deleted_custom_blocks[]",value:blockName}).appendTo(this.saveForm)},ProjectsOverviewController.prototype.updateAvailableBlocks=function(){var currentBlocks=this.activeBlockNames();this.$element.find("#block-select option").each(function(i,el){var option=angular.element(el),blockName=option.val(),isDisabled=""===blockName||currentBlocks.indexOf(blockName)!==-1;option.prop("disabled",isDisabled)})},ProjectsOverviewController.prototype.blockNameFromId=function(id){return id.replace(/^block_/,"")},ProjectsOverviewController.prototype.idFromBlockName=function(name){return"#block_"+name},ProjectsOverviewController.prototype.handleSaveChanges=function(){var _this=this;this.$element.find(".widget-container").each(function(i,el){var container=angular.element(el),group=container.data("position"),ids=_this.activeBlockNames(container);_this.saveForm.find("[name="+group+"]").val(ids.join(","))})},ProjectsOverviewController.prototype.handleBlockSelection=function(){var _this=this;this.$http({url:this.addForm.attr("action"),method:"POST",data:{block:this.selectedBlock},headers:{Accept:"text/html"}}).then(function(response){var blockName=response.data.match(/id="block_(.*?)"/)[1];_this.addBlock(blockName,response.data),_this.updateAvailableBlocks()}).catch(function(error){_this.wpNotificationsService.handleErrorResponse(error)}).finally(function(){_this.selectedBlock=null})},ProjectsOverviewController.prototype.updateBlock=function(blockName,content){var block=this.$element.find(this.idFromBlockName(blockName));content=this.compileBlock(content),block.replaceWith(content)},ProjectsOverviewController.prototype.updateAttachments=function(){var _this=this,attachments=this.$element.find("#page_layout_attachments");this.$http({url:attachments.data("refreshUrl"),method:"GET",headers:{Accept:"text/html"}}).then(function(response){attachments.html(response.data)}).catch(function(error){_this.wpNotificationsService.handleErrorResponse(error)})},ProjectsOverviewController.prototype.addBlock=function(blockName,content){content=this.compileBlock(content),this.hiddenContainer.append(content),this.$element.find(this.idFromBlockName(blockName))[0].scrollIntoView()},ProjectsOverviewController.prototype.compileBlock=function(content){var compileFn=this.$compile(content);return compileFn(this.$scope,void 0,{transcludeControllers:{overviewPageLayout:{instance:this}}})},ProjectsOverviewController}();exports.ProjectsOverviewController=ProjectsOverviewController,angular.module("openproject").directive("overviewPageLayout",overviewPageLayout)},494:function(module,exports,__webpack_require__){"use strict";function overviewTextileBlock(){return{restrict:"EA",scope:{newBlock:"=?",blockName:"@"},transclude:!0,compile:function(){return function(scope,element,attrs,ctrl,transclude){scope.$ctrl.layoutCtrl=ctrl,transclude(scope,function(clone){element.append(clone),scope.$ctrl.initialize()})}},require:"?^overviewPageLayout",controller:OverviewTextileBlockController,bindToController:!0,controllerAs:"$ctrl"}}Object.defineProperty(exports,"__esModule",{value:!0});var OverviewTextileBlockController=function(){function OverviewTextileBlockController($element,$timeout,$window,$q,I18n,NotificationsService){this.$element=$element,this.$timeout=$timeout,this.$window=$window,this.$q=$q,this.I18n=I18n,this.NotificationsService=NotificationsService,this.formVisible=!1}return OverviewTextileBlockController.$inject=["$element","$timeout","$window","$q","I18n","NotificationsService"],OverviewTextileBlockController.prototype.initialize=function(){this.newBlock&&this.toggleEditForm(!0)},Object.defineProperty(OverviewTextileBlockController.prototype,"editing",{get:function(){return!!this.layoutCtrl},enumerable:!0,configurable:!0}),OverviewTextileBlockController.prototype.toggleEditForm=function(state){void 0===state&&(state=!this.formVisible),this.formVisible=state},OverviewTextileBlockController.prototype.remove=function(){this.$window.confirm(this.I18n.t("js.text_are_you_sure"))&&this.$element.remove()},OverviewTextileBlockController.prototype.submitForm=function(evt){var _this=this,form=this.$element.find(".textile-form"),formData=new FormData(form[0]),deferred=this.$q.defer();return this.loadingIndicator=deferred.promise,jQuery.ajax({url:form.attr("action"),method:"PUT",data:formData,cache:!1,contentType:!1,processData:!1}).done(function(response){deferred.resolve(),_this.$timeout(function(){_this.NotificationsService.addSuccess(_this.I18n.t("js.notice_successful_update"))}),_this.layoutCtrl.updateBlock(_this.blockName,response),_this.layoutCtrl.updateAttachments()}).fail(function(error){deferred.reject(),_this.$timeout(function(){_this.NotificationsService.addError(_this.I18n.t("js.notification_update_block_failed")+" "+error.responseText)})}),evt.preventDefault(),!1},OverviewTextileBlockController}();exports.OverviewTextileBlockController=OverviewTextileBlockController,angular.module("openproject").directive("overviewTextileBlock",overviewTextileBlock)}});