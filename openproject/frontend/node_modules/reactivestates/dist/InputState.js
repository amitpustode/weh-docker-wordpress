"use strict";function input(t){return void 0===t&&(t=void 0),new InputState(t)}var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var rxjs_1=require("rxjs"),State_1=require("./State"),InputState=function(t){function e(e){var i=this,r=function(t){return void 0===t},s=function(t,i){i(e)},n=function(t,e){t.hasValue()&&e(void 0)},o=new rxjs_1.Subject;return i=t.call(this,o,r,s,n)||this,i.state=o,i.timestampOfLastPromise=-1,i}return __extends(e,t),e.prototype.putValue=function(t,e){return this.state.next(t),this},e.prototype.clearAndPutFromPromise=function(t){var e=this;return this.hasValue()&&this.clear(),this.timestampOfLastPromise=Date.now(),t.then(function(t){e.timestampOfLastPromise=-1,e.putValue(t)},function(){e.timestampOfLastPromise=-1,e.clear()}),this},e.prototype.isPristine=function(){return!this.hasValue()&&!this.hasActivePromiseRequest()},e.prototype.hasActivePromiseRequest=function(){return-1!==this.timestampOfLastPromise},e.prototype.isPromiseRequestOlderThan=function(t){return Date.now()-this.timestampOfLastPromise>t},e.prototype.putFromPromiseIfPristine=function(t){return this.isPristine()&&this.clearAndPutFromPromise(t()),this},e.prototype.clear=function(t){return this.putValue(void 0),this},e.prototype.doModify=function(t,e){var i=this;if(this.hasValue())this.values$().take(1).subscribe(function(e){var r=t(e);r instanceof rxjs_1.Observable?r.take(1).subscribe(function(t){i.putValue(t)}):i.putValue(r)});else{var r=e();r instanceof rxjs_1.Observable?r.take(1).subscribe(function(t){i.putValue(t)}):this.putValue(r)}return this},e}(State_1.State);exports.InputState=InputState,exports.input=input;
//# sourceMappingURL=InputState.js.map
